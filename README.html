<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>MMXMPCR</title>
<meta name="keywords" content="Linux, XM Radio, XM PCR, Michael Minn, Satellite Radio, USB">
<meta name="description" content="MMXMPCR, a kernel module and command line program for playing the XM Radio PCR satellite radio receiver">
</head>
<body bgcolor=white>

<h1>MMXMPCR</h1>

<p>Author: Michael Minn <a href="mailto:mmxmpcr@michaelminn.com"><tt>&lt;mmxmpcr@michaelminn.com&gt;</tt></a>
<p>December 11, 2003

<hr SIZE="1">
<i>MMXMPCR, a kernel module and command line program for playing the XM Radio PCR satellite radio receiver</i>
<hr SIZE="1">

<!-------------------------------------------------------->

<h2>1. Introduction</h2>

<p>MMXMPCR is a simple MOTIF GUI for playing the XM PCR USB satellite radio receiver.
The XM PCR is an inexpensive USB device that permits listening to XM satellite radio through a PC.
The PC only provides the means for viewing and selecting channels. Audio output from the device
is analog via a 1/8&quot; phone jack that can be plugged into a computer sound card or a home
stereo system. Digital audio output is not available from the device.

<p>The XM PCR is recoginized as a USB serial device by the ftdi_sio kernel module that
is provided in most Linux distros and was built to support the FTDI RS-232 USB serial port convertor. 
The user GUI program is a simple MOTIF list box that displays 
what is currently playing on the various XM radio channels and permits the user to change channels.

<p>MMXMPCR has only been tested under Red Hat 8.0 (2.4.18-14 kernel), although it should work under any
contemporary Linux distro and the author welcomes feedback regarding success or failure under
other versions of Linux.

<p>The communications protocol has been partially deciphered and posted on the
<a href=http://www.xmfan.com>XM Fan Website.</a> I also did some work using USB Snoopy under Windoze. 
Although the protocol seems relatively simple, there are some messages of unknown purpose
that must be sent on faith. No attempt has been made to find a way of defeating the subscription 
protection that is apparently built into the device. Since the future of XM Radio is tenuous and 
dependent on income from a subscription base, I would encourage you to support this fabulous resource 
rather than expending effort on trying to get it for free.

<p>MMXMPCR is provided to the open source community to promote further adoption of this device.
There are other existing packages out there.
MMXMPCR  is free software; you can redistribute it and/or modify
it under the terms of version 2 the GNU General Public License as published by
the Free Software Foundation.  It is provided to the open source community
without a warranty of any kind.

<p>I LOVE XM Radio and can't imagine how I lived my life without it.  Get it today!

<!---------------------------------------------------->

<hr SIZE="1">
<h2>2. Version History &amp; Download</h2>

<p><b><a href="http://www.michaelminn.com/linux/mmxmpcr/mmxmpcr-2003.12.06.tgz">Version 2003.12.11</a></b>:
Add mouse wheel page scrolling.
Filter out bogus channel info messages.
Refreshes only visible channels so refresh is faster.
Added shortcut keys - required significant modification of widget implementation.
Fixed scrolling and selection display problems from premature 12.06 release.

<p><b><a href="http://www.michaelminn.com/linux/mmxmpcr/mmxmpcr-2003.07.08.tgz">Version 2003.07.08</a></b>:
Upgrade to use the ftdi_sio module - proprietary mmxmpcr module no longer needed;
Cleared up junk display due to overlapping channel info request messages.

<p><b><a href="http://www.michaelminn.com/linux/mmxmpcr/mmxmpcr-2003.06.14.tgz">Version 2003.06.14</a></b>:
Initial release that compiles under Red Hat 8.0


<!------------------------------------------------------------>

<hr SIZE="1">
<h2>3. Installation</h2>

<p>MMXMPCR consists of a single C++ source file that compiles into a simple MOTIF GUI executable (mmxmpcr).
Download a tarball from the version list above and AS SUPERUSER decompress the tarball and make install:

<pre>
	tar -zxvf mmxmpcr*.tgz
	cd mmxmpcr
	make install
</pre>


<!------------------------------------------------------------>

<hr SIZE="1">
<h2>4. Uninstall</h2>

<p>MMXMPCR can be uninstalled by typing &quot;make uninstall&quot; in the
source code directory you created above. You can also go into /usr/local/bin
and manually delete the mmxmpcr executable.


<!------------------------------------------------------------>

<hr SIZE="1">
<h2>5. Operation</h2>

<p>It is recommended that you go through the setup and subscription process
for the XM PCR under Windoze before attempting to use it under Linux. The signal strength
meter is important for troubleshooting setup and no meter is provided with MMXMPCR.

<p>MMXMPCR can be invoked from the command line with &quot;mmxmpcr&quot;. There 
are no command line arguments. 

<p>The initialization protocol takes a few seconds and a list of channels should pop up.
The list refreshes sequentially and not very quickly. You can select a channel by clicking on
the appropriate list entry. Nothing will play until you select a channel.

<p>Channels are organized in groups of 10, which works out nicely for a single page
of display. You will notice large gaps in the list reserved for unused channels. Selecting an unused
channel will give unpredictable behavior - usually nothing happens. 

<p>The MMXMPCR program can be terminated by clicking the close icon in the title bar.
The XM PCR will continue playing the last selected channel if the MMXMPCR program is terminated.
Sound can be stopped by by unplugging the device, powering down the computer, or
restarting MMXMPCR (which resets the device).

<p>MMXMPCR can also be operated with the following shortcut keys:
<pre>
	PgUp: display up one page
	PgDn: display down one page
	0 - 9: select channel (i.e. if top channel on the page is 40, key 5 selects channel 45)
	q: quit
</pre>

<p>Fast, simple, effective. No pretty graphics, but this is about sounds, not pictures.

<hr SIZE="1">

<!------------------------------------------------------------>

<hr SIZE="1">
<h2>6. Protocol</h2>

<p>Courtesy of Bushing and Dobbz via the <a href=http://www.xmfan.com/viewtopic.php?t=6870&sid=18085bac1e7ad8d0750ec3a324bf0b1a>
XM Fan XMPCR Hardware & Development Message Board</a>.

<pre>
Requests from PC to PCR:

All requests take the form:

5A A5 xx xx <data> ED ED

where xx xx is the length of the data field in big-endian (MSB first) format

For example:

5A A5 00 05 00 10 10 01 ED ED -- power unit on


Known commands:
00 10 10 10 01    -- power on. see response 80
01 00      -- power off. see response 81
13 00       -- ? see response 93
25 08 xx 00   -- get channel info. see response A5
25 09 xx 00   -- get channel info. see response A5
31      -- get radio ID. see response B1
42 01      -- ? see response C2
43      -- get signal strength info. see response C3
50 00 00 00 00 00 -- ?
70 05      -- get radio info? see response E3


Responses from PCR to PC:

All responses take the form:

5A A5 xx xx <data> yy yy

where xx xx is the length of the data field in big-endian format
      yy yy is the last two bytes of the data field, repeated (why?)

Many response codes seem to be the request codes with the MSB set high.

Known responses:

80: HELLO
80 ?? ?? ?? aa bb cc dd ee ?? ?? ?? ?? ff gg hh ii jj ?? <XMID>
   aa         "SDEC Ver." in BCD
   bb/cc/ddee    SDEC revision date, in BCD
         (note: My PCR returns 25 10 29 20 02, but diag.exe
         refers to this as "SDEC Ver. 25 (10/02/2002)) ???
   ff
        gg/hh/iijj    XMSTK version info
   <XMID> XM ID in ASCII, 8 characters long
   Sent on poweron. See request 00 01.

81: GOODBYE
81 ?? ?? ??
    Sent on power down.  See request 01.

93: ??
93 ?? ?? ??
    See request 13 00.

A5: CHINFO
A5 ?? ?? aa bb ?? XX XX XX XX XX XX XX XX XX XX
XX XX XX XX XX XX ?? ?? YY YY YY YY YY YY YY YY
YY YY YY YY YY YY YY YY ?? ZZ ZZ ZZ ZZ ZZ ZZ ZZ
ZZ ZZ ZZ ZZ ZZ ZZ ZZ ZZ ZZ WW WW WW WW WW WW WW
WW WW WW WW WW WW WW WW WW ?? ?? ?? ??

   aa   Channel number.  This is one two low when 25 09 is used?
   bb    Usually the same as the channel number -- but not always.
   XX   Station name.  (16 chars)
   YY    Genre name.    (16 chars)   all are padded with trailing
        ZZ   Artist name.   (16 chars)   whitespace (0x20)
   WW   Song title.    (16 chars)
    See request 25 08, 25 09.

B1: GETID
B1 ?? ?? ?? XX XX XX XX XX XX XX XX
   XX   XM ID, in ASCII. (8 chars)
   See request 31.

C1: ??
C1 ??

C2: ??
C2 ?? ??
   See request 42 01.

C3: Signal strength?
C3 <lots and lots of numbers. :)>
   See request 43.

D0: ??
D0 ?? ?? ??
   See request 50.

E0: Some sort of seperator or ACK?
E0

E3: XM INFO
E3 ?? ?? ?? XX XX XX XX XX YY YY YY YY YY ZZ ZZ ZZ ZZ ZZ
   XX CBM Version
   YY XMSTK Version
   ZZ SDEC Version   (see 80 for more details)
   See request 70 05. 


Issue 5AA5000425090000EDED, and it will return a channel. Then you ack 
with 5AA500042509 xx 00EDED for whatever channel it just sent. It will 
then send you the next channel in the list. Repeat until it finishes. 

Changing a channel
5AA500061002 xx 000001EDED

</pre>

</body>
</html>








